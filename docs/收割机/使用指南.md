---
title: 04. 使用指南
description:
published: true
date: 2025-12-01T04:41:11.923Z
tags: [ 使用指南, ]
editor: markdown
dateCreated: 2024-11-26T12:43:16.455Z
---

# 收割机使用指南

## 1. 安装部署

> 1. <font color="red">目前辅种需要映射种子文件，所有种子文件夹均需要映射至`/downloaders/文件夹下`</font>
>
>    >  <font color="orange">远程下载器可以使用同步工具同步config文件夹到安装 Harvest 的设备上，实现辅种效果</font>
>
> 2. `DEFAULT_PROXY`: 此代理会在 PTPP 导入、CookieCloud 同步、油猴添加站点时直接设置为同步站点的代理，已为部分不能使用代理访问的站点屏蔽，如果不打算设置代理，请删掉此项

### 推荐使用 docker-compose 方式安装

```yaml
services:
  harvest: # 服务名称
    image: newptools/harvest # 镜像名称，下载不下来时可以修改为：`docker.1panel.live/newptools/harvest`或者`docker.liuweiran.top/newptools/harvest`
    ports: # 端口映射，前面为本地端口，后面为容器服务端口
      - "28000:8000" # Django服务端口
      - "25566:5566" # Flower服务端口 => flower 用户监测后台任务
      - "29001:9001" # supervisor服务端口 => supervisor 用于管理 docker 内部服务进程
      - "25174:5173" # nginx服务端口 => nginx 反代内部服务端口，对外提供服务
    volumes: # 所有的文件映射都要写在这里，冒号前面为本地文件夹，后面为容器内部文件夹，`.`表示当前文件夹，.后面的都是相对当前文件的路径，群晖由于系统限制，冒号前面的目录必须已存在，否则启动会报错
      - ./db:/app/db # 数据保存目录
      - ./sites:/app/sites # 自定义站点配置文件夹
      - ./icons:/icons # 自定义站点图标文件夹，图标必须为png格式，名称请点击编辑站点看站名称，自定义的与配置文件名称保持一致
      - ./downloads:/downloads #右侧为固定值，必须映射为/downloads，如有多个文件夹需要映射，请映射为/downloads的子文件夹
      - ./qbittorrent1:/downloaders/qbt1 #  qb下载器种子文件映射目录，如不需要辅种功能，下载器可以不映射，要映射到BT_backup 文件夹的上一级，冒号后面为固定格式，必须是/downloaders/xxxxx   
      - ./tr2:/downloaders/tr2  # Tr下载器种子文件映射目录，如不需要辅种功能，可以不映射，映射到torrents文件夹的上一级，固定格式必须是/downloaders/xxxxx
    environment: # 环境变量
      - TOKEN=YOUR-TOKEN # 授权码，向开发者购买
      - DJANGO_SUPERUSER_USERNAME=admin # 默认用户名，可以更改
      - DJANGO_SUPERUSER_EMAIL=YOUR-EMAIL # 生成授权所用的邮箱，不可改
      - DJANGO_SUPERUSER_PASSWORD=adminadmin # 密码随便修改
      - WEBUI_PORT=5173 # WEB访问端口，host 模式遇到端口冲突时修改，同步修改上面的ports处;网络模式为桥接是无需修改
      - DJANGO_WEB_PORT=8000 # Django端口，修改注意事项同上
      - REDIS_SERVER_PORT=6379 # Redis队列缓存服务，修改注意事项同上
      - FLOWER_UI_PORT=5566 # flower自动任务监测，修改注意事项同上
      - SUPERVISOR_UI_PORT=9001 # supervisor服务管理端口，修改注意事项同上
      - CloudFlareSpeedTest=true # cloudflare 测速开关，如果你有VPN 代理环境，这里可以直接设置为 false
      - AUTO_UPDATE=true # 自动更新开关，设置为true时，启动会自动拉取最新代码，如果自动更新出错，请设置为 false
      - DEFAULT_PROXY=YOUR-PROXY # 此代理会在 CookieCLoud 同步时直接设置为同步站点的代理，已为部分不能使用代理访问的站点屏蔽，如果不打算设置代理，请删掉此项
    restart: always # 重启策略，一般无需修改
    hostname: harvest # 容器主机名，冲突时可修改
    container_name: harvest # 容器名称，冲突时可修改
    network_mode: bridge # 桥接模式，根据需要换成host模式
```

## 2. 登录收割机

打开WEBUI或者使用APP、桌面客户端登录

### 1. 登录端口确认

如果你使用host主机模式部署，通常WEBUI访问端口为5173

如果你使用bridge桥接模式部署，通常WEBUI访问端口为5173映射的端口，例如上面的compose配置文件中的WEBUI端口就是25174

### 2. 添加服务器

WEBUI或者APP打开后，首页是服务器添加页面，点击添加服务器，跳出信息填写窗口，如果未修改DJANGO_SUPERUSER_USERNAME和DJANGO_SUPERUSER_PASSWORD这两个环境变量，那么默认的账号：admin，密码：adminadmin，只有测试通过的服务器才能保存添加。

![img.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img.png)	

### 3. 修改服务器信息

服务器信息添加完成后，如果修改了账号密码，可以双击服务器进行修改，保存同样需要先通过连接测试。

## 3. 添加基础系统设置

### a. 添加消息通知

个人觉得，登录后的第一件事就是添加一个自己用的顺手的消息通知，收割机支持多种消息通知渠道，任选其一即可。

>  之前一直推荐使用WxPusher或者IYUU，因为收割机的通知内容为Markdown格式，这两个通知可以完美兼容，但是最近 Wxpusher 被微信封杀，需要单独下载 APP 才能正常使用，所以目前推荐：IYUU 和企业微信

1. <font color="orange">IYUU【推荐】</font>
2. wxpusher
3. pushplus
4. <font color="orange">企业微信【推荐】</font>
5. Telegram
6. Bark
7. PushDeer

### b. 添加安全Token

>  安全 Token是接口访问工具使用的验证密码，请妥善保存，这个 Token 会用在油猴脚本、收割机浏览器插件，以及企业微信验证。
>  	
>  添加方法：在 APP 中打开系统设置，并添加油猴 Token，后期会改为安全Token，可以自定义，也可以使用随机按钮生成 Token，没有此选项的请点击右下角➕添加
>  	
>  ![img_1.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_1.png)

### c. 添加OCR文字识别服务【空和皇后签到使用】

1. 申请刚百度 OCR 免费服务：[教程地址](/通用教程/baidu-ocr)
2. 在系统设置中添加百度 OCR 相关配置

## 4. 导入站点

参考文章：[导入站点](import)

## 5. 添加计划任务

> <font color="orange">收割机本身并不会主动去访问网站，所有的访问均需要设置计划任务后，按照计划任务制定的时间执行</font>

	可用的计划任务有：
	
	1. CloudFlare 测速【PT 站点多使用 CF 进行代理，连接性不太好，测速后效果能好一点】
	2. 阿里云盘签到【阿里云盘签到，每个月需要更新一次 Token】
	3. 抓取站点信息【所有站点数据都依托此任务】
	4. 站点签到【签到，不用多说】
	5. RSS 订阅【扫描 添加的 RSS 信息，订阅你需要的影视内容】
	6. 辅种任务【这个也不用多少是干啥的了】

添加任务：
	
![img_2.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_2.png)![](https://img.ptools.fun/blog/image-20250617202153728.png)
	

任务执行时间支持指定时间和 Cron 表达式，如果你是高阶用户，可以打开高级选项进行更精细的设定，一般来说，分钟和小时两个选项已经够用。
 
指定时间：直接指定任务要执行的时间，比如，你需要 9 点10 分执行任务，就分钟填写 10，小时填写 9 即可。
 
Cron 时间：一般 Cron 网站都提供 6 位表达式，我们使用的是 5 位表达式，省去了第一位的秒，比如，你希望每天的 1 点、3 点、9 点、19 点、23 点更新数据，就可以指定一个固定的分钟时间，这里我指定未 13 分钟，小时部分直接填写：`1,3,9,19,23`，中间用英文逗号隔开，保存即可，任务会在每天的 1 点、3 点、9 点、19 点、23 点的 13 分执行，以此类推。

### 辅种

辅种只需要三步
	

1. 在部署docker时映射下载器种子文件夹

   ![img_3.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_3.png)   

2. 添加下载器时关闭刷流

   ![img_4.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_4.png)

3. 添加辅种计划任务

   ![img_5.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_5.png)
### 种子迁移
好多小伙伴儿都喜欢QB下载，TR保种，所以需要将种子从QB转移到TR
> 与辅种一样，需要提前映射种子文件夹，如果辅种任务已经映射过了，不需要重复操作

#### 1. 在计划任务页面点击 + 按钮，选择转种任务  
![img_21.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_21.png)

#### 2. 填写任务名称，并选择源下载器和目标下载器
> 选中源下载器后，目标下载器会自动筛选统一服务器上的下载器  
> 
![img_22.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_22.png)
![img_23.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_23.png)

#### 3. 选定转种范围  
1. 选中下载器后，会生成从源下载器默认下载文件夹到目标下载器默认文件夹的映射，请自行修改  
   ![img_24.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_24.png)
2. 映射规则说明：
> - 映射以`->`箭头分割，前面是源下载器路径，后面是目标下载器路径   
> - 任务执行时从源下载器读取设定路径下的所有种子，推送到目标下载器设定路径，请保证前后路径都可以正常读取资源文件

#### 4. 其他说明
1. 目标为QB下载器时支持跳过校验
2. 支持转种完成后删除源种子  
   > - 删除时校验未通过的种子会忽略
   > - 从QB转种到TR时有几率会丢失Tracker信息，收割机在种子推送完成后会对种子Tracker进行校验，丢失Tracker的会从源下载器重新读取并更新到目标种子上
   > - 删种时也会忽略自动修复Tracker失败的种子  

![img_25.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_25.png)

### 订阅

> #### 订阅任务间隔建议大于5分钟

1. 去要订阅的网站生成RSS链接，并添加到收割机

   ![img_6.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_6.png)

2. 导入默认订阅标签，如果没有合适的标签，可以自己手动添加

   ![img_7.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_7.png)	

3. 添加订阅

   ![img_8.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_8.png)	

4. 选择当前订阅要使用的订阅标签

   ![img_9.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_9.png)	

5. 添加RSS扫描任务

   ![img_10.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_10.png)

## 站点信息详解

![img_11.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_11.png)

![img_12.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_12.png)	
    

![img_13.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_13.png)	
    
 站点信息右上角的图标是操作按钮
 
 当按钮是黄色：表示当前站点需要签到，但是还未签到或者未签到成功
 
 当按钮是绿色：表示当前站点已经完成签到，可以查看签到历史信息	
 
 站点历史可以查看站点自加入收割机依赖的数据变化曲线和柱图

![img_14.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_14.png)

![img_15.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_15.png)

![img_16.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_16.png)

![img_17.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_17.png)	

## 用户管理

### 添加用户

![img_18.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_18.png)	

### 删除用户

 用户行左滑即可打开操作菜单，点击删除即可打开删除确认菜单。
	

### 修改密码

1. 点击编辑即可打开修改窗口，可以修改用户名和密码

> 1. 只有管理员有删除权限
> 2. 管理员才能看到用户管理菜单
> 3. 不能删除本账户

![img_19.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_19.png)		

## 升级更新

### APP内更新Docker镜像

APP 端SSH管理功能已升级，在满足先决条件的情况下，目前没遇到不能用的NAS
![img_20.png](/images/%E6%94%B6%E5%89%B2%E6%9C%BA/%E6%8C%87%E5%8D%97/img_20.png)		

#### 1. 先决条件：当前用户要可以直接运行 docker 命令

如果不能运行，可以参考一下内容

[文章直达](/%E6%94%B6%E5%89%B2%E6%9C%BA/ssh)


###  飞牛/极空间/绿联/UNAS等基于Debian的NAS系统：

1. 使用你的账号SSH 进入系统
2. 运行命令`sudo usermod -a -G docker 你的用户名`
3. 退出，重新链接，测试 docker 命令是否有权限


### 群晖

 1. SSH登录
 2. `sudo synogroup --add docker`
 3. `sudo synogroup --memberadd docker 用户名` # 用户名替换为你的用户名
 4. 重启群晖

#### 2. 监测到docker镜像有更新时，会出现一个下载按钮，你可以选择直接点击下载然后重建，也可以直接左滑指定容器，选择重建

#### 3. 左滑点击重建按钮，会自动下载最新镜像并使用原配置重建容器


### APP内更新代码	

在APP中点击右上角升级按钮，会打开小窗口
 
1. 窗口打开时会读取服务端代码远端最新版本与本地版本，可以点击更新升级本地所有代码
2. 窗口中点击手动操作可以分别更新django主服务代码、WEBUI代码和站点配置文件

### 重启更新

重启更新需要添加环境变量：`AUTO_UPDATE=true`，默认已添加，如果不需要，可以改为`false`
	
很简单，重启即可，可以在SSH管理中右滑选择重启
	
	